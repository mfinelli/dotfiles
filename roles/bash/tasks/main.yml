---
- name: create bash directory
  ansible.builtin.file:
    path: "{{ ansible_user_dir }}/.bash"
    owner: "{{ whoami }}"
    group: "{{ whoami_group }}"
    mode: 0755
    state: directory

- name: download bash-it
  ansible.builtin.git:
    dest: "{{ ansible_user_dir }}/.bash/bash-it"
    repo: https://github.com/Bash-it/bash-it.git
    version: v2.1.4

# this is ok, because boostrap.bash calls dotfiles.yml as the playbook
- name: link the bash profile configuration
  ansible.builtin.file:
    dest: "{{ ansible_user_dir }}/.bash_profile"
    src: "{{ playbook_dir }}/roles/bash/files/bash_profile"
    state: link
    force: yes

- name: install bashrc
  ansible.builtin.template:
    dest: "{{ ansible_user_dir }}/.bashrc"
    owner: "{{ whoami }}"
    group: "{{ whoami_group }}"
    mode: 0600
    src: bashrc.j2

- name: cleanup old bash_functions
  ansible.builtin.file: path={{ item }} state=absent
  loop:
    - "{{ ansible_user_dir }}/.bash/bash_functions
    - "{{ ansible_user_dir }}/.bash_functions
