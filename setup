#!/bin/bash

# in case we didn't clone recursively
git submodule update --init

if [[ -f ~/.bashrc ]]; then
    rm ~/.bashrc
fi

if [[ ! -d ~/.ssh ]]; then
    mkdir ~/.ssh && chmod 700 ~/.ssh
fi

if [[ ! -f ~/.ssh/known_hosts ]]; then
    touch ~/.ssh/known_hosts
fi

chmod 755 mutt/.mail/{,mario@finel.li,mario@scul.ch}

for key in $(ls ssh/.ssh/*.asc); do
    gpg -d $key > ssh/.ssh/$(basename $key .asc) && \
        chmod 600 ssh/.ssh/$(basename $key .asc)
done

for vpn in $(ls vpn/.vpn/*.tgz.asc); do
    gpg -d $vpn | tar zx -C vpn/.vpn
done

stow bash
stow gnupg
stow mutt
stow ssh
stow vim
stow vpn
